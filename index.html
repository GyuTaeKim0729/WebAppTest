<!doctype html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>앱 설치 테스트</title>
</head>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">

    var launchAppUrl = 'YouTube://'; // 앱 스키마
    var schInterval; // 인터벌
    var timer;	// 타이머
    var ban = false;
    var installed = false;
    var check_timer;

    var beforediv;
    var afterdiv;
    var faildiv;

    function init() {
                
        beforediv = document.getElementById("before")
        afterdiv = document.getElementById("after")
        faildiv = document.getElementById("fail")

        location.href = launchAppUrl;

        check_timer = setInterval(check,200);

        timer = setTimeout(function () {
            //alert('앱이 설치되어있지 않습니다.');
            beforediv.style.display = "none";
            faildiv.style.display = "block";
            ban = true;
            clear();
        }, 500);


        /*
        document.addEventListener("visibilitychange", function () {
            clearTimeout(timer);
            if (installed == false && ban == false) {
                clearTimeout(timer);
                //alert("앱이 설치 되어 있습니다.");
                installed = true;
                beforediv.style.display = "none";
                afterdiv.style.display = "block";
                faildiv.style.display = "none";
            }
        });
        */
    }
    
    function check() {
        if (document.webkitHidden || document.hidden) {
            clear();
            beforediv.style.display = "none";
            afterdiv.style.display = "block";
            faildiv.style.display = "none";
        }
    }

    function clear() {
        clearTimeout(timer);
        clearInterval(check_timer);
    }
    


</script>



<body onload="init()">
    <div id="before">
        <div style="text-align: center; margin-top: 100px;">잠시후 어플이 실행됩니다.3</div>
        <div style="text-align: center; margin-top: 30px;">실행 종료 후 여기로 다시 복귀해서 인증해주시길 .</div>
    </div>
    <div id="after" style="text-align: center;display: none;">
        <div style="text-align: center; margin-top: 100px;">확인 후 키오스크 확인해주세요.</div>
        <button>PUSH</button>
    </div>
    <div id="fail" style="display: none;">
        <div style="text-align: center; margin-top: 100px;">어플 설치가 되어있지 않습니다.</div>
        <div style="text-align: center; margin-top: 30px;">설치 후 다시 시도해주세요.</div>
    </div>
</body>

</html>
